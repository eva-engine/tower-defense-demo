{"version":3,"sources":["data/index.ts","components/Weapon/index.tsx","components/WeaponDetail/index.tsx","pages/Home/index.tsx","scripts/components/player.ts","scripts/components/clock.ts","scripts/components/log.ts","scripts/components/map.ts","scripts/components/wave.ts","scripts/components/enemy.ts","scripts/components/weapon.ts","scripts/prefab.ts","scripts/game.ts","components/Result/index.tsx","pages/Game/index.tsx","App.tsx","index.tsx"],"names":["GameData","baseDamage","normal","fire","water","wood","map","distance","column","row","player","HP","Gold","position","x","y","weapons","name","info","element","level","cost","damage","cd","delay","enemys","resistance","speed","waves","enterTime","UserData","weapon","enemy","wave","Weapon","onSelected","selected","className","onClick","WeaponDetail","restGold","onLvChange","useState","setLevel","style","display","Home","history","useHistory","gold","setGold","selectedWeapon","setSelectedWeapon","onWeaponSelect","useCallback","onWeaponLvChange","href","push","memo","PlayerComponent","params","healthPoint","this","Component","componentName","PlayerSystem","decorators","componentObserver","conponentChanged","clear","changed","gameObject","component","heartHpTransform","transform","children","find","childTransform","textComponent","getComponent","Text","text","Math","max","game","emit","win","System","systemName","now","performance","Date","ClockComponent","_startTime","fn","time","setInterval","Promise","resolve","setTimeout","GameLogComponent","message","logs","join","add","format","m","floor","s","mm","toString","padStart","gamelog","componentChanged","clockComponent","scene","console","startTime","length","MapComponent","MapSystem","ceil","width","height","routeDistance","helper","grids","i","j","gridHelper","GameObject","size","gridLine","addComponent","Graphics","graphics","lineStyle","moveTo","lineTo","addChild","logComponent","anchor","origin","debug","WaveComponent","count","EnemyStatus","WaveSystem","playComponent","gameObjects","EnemyComponent","enemyName","status","idle","moving","clearInterval","walking","DragonBone","play","repeat","dead","queen","EnemySystem","mapSystem","waveComponent","playerComponent","getSystem","props","prop","mapComponent","gameLogComponent","victory","destroy","die","healthBarTransform","child","healthBarGraphic","healthPointWidth","beginFill","drawRoundedRect","endFill","WeaponComponent","weaponName","attackCount","attacking","a","b","round","then","WeaponSystem","filter","eventComponent","Event","multiDamge","enemyComponet","realDamage","sumDamange","createGameObject","scale","graphic","image","dragonebone","event","box","color","shape","drawRect","drawCircle","drawStar","Img","resource","anime","armatureName","autoPlay","on","times","animationName","playerResource","type","RESOURCE_TYPE","DRAGONBONE","src","url","tex","ske","preload","IMAGE","weaponResources","weaponArmatures","data","fontSize","fill","bulletResources","bullet","render","Render","alpha","removeComponent","animation","Transition","group","values","value","tween","once","enemyResources","enemyConfig","addResource","GameScript","userData","canvasEl","canvasWidth","offsetWidth","sceneHeight","offsetHeight","Game","frameRate","autoStart","systems","RendererSystem","canvas","transparent","resoution","TextSystem","EventSystem","GraphicsSystem","DragonBoneSystem","ImgSystem","TransitionSystem","RenderSystem","heart","hp","stroke","strokeThickness","prefab","Infinity","addPlayer","addWeapons","initGame","initScene","config","badge","healthBarBorder","healthBarBorderGraphc","healthBar","pastTime","addEnemy","enemyComponent","enter","move","weaponComponent","attackEffect","attack","remove","start","startWave","startAttack","pause","Result","result","reset","window","location","replace","setResult","useRef","useEffect","current","init","onEnd","destory","ref","App","path","strict","ReactDOM","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.507eb71a.chunk.js","sourcesContent":["import { EVAGame } from '../eva-game-types';\n\nexport const GameData: EVAGame.IGameData = {\n  baseDamage: {\n    normal: 1,\n    fire: 1,\n    water: 1,\n    wood: 1,\n  },\n  map: {\n    distance: 10,\n    column: 5,\n    row: 13,\n  },\n  player: {\n    HP: 4,\n    Gold: 290,\n    position: {\n      x: 3,\n      y: 12,\n    },\n  },\n  weapons: [\n    {\n      name: '普通',\n      info: '普通攻击属性武器',\n      element: 'normal',\n      level: 1,\n      cost: 14,\n      damage: {\n        normal: 1,\n        fire: 0,\n        water: 0,\n        wood: 0,\n      },\n      cd: 500,\n      delay: 100,\n      position: {\n        x: 1,\n        y: 12,\n      },\n    },\n    {\n      name: '火系',\n      info: '火系攻击属性武器',\n      element: 'fire',\n      level: 1,\n      cost: 16,\n      damage: {\n        normal: 0.6,\n        fire: 1.2,\n        water: 0.1,\n        wood: 0,\n      },\n      cd: 900,\n      delay: 200,\n      position: {\n        x: 2,\n        y: 12,\n      },\n    },\n    {\n      name: '水系',\n      info: '水系攻击属性武器',\n      element: 'water',\n      level: 1,\n      cost: 18,\n      damage: {\n        normal: 1,\n        fire: 0,\n        water: 5,\n        wood: 0,\n      },\n      cd: 2000,\n      delay: 500,\n      position: {\n        x: 4,\n        y: 12,\n      },\n    },\n    {\n      name: '木系',\n      info: '木系攻击属性武器',\n      element: 'wood',\n      level: 1,\n      cost: 24,\n      damage: {\n        normal: 1.8,\n        fire: 0,\n        water: 0,\n        wood: 4.5,\n      },\n      cd: 1500,\n      delay: 500,\n      position: {\n        x: 5,\n        y: 12,\n      },\n    },\n  ],\n  enemys: [\n    {\n      name: '普通史莱姆',\n      element: 'normal',\n      HP: 350,\n      damage: 1,\n      resistance: {\n        normal: 1,\n        fire: 0.5,\n        water: 0.5,\n        wood: 0.5,\n      },\n      speed: 1.2,\n    },\n    {\n      name: '火系史莱姆',\n      element: 'fire',\n      HP: 500,\n      damage: 1,\n      resistance: {\n        normal: 0.8,\n        fire: 1,\n        water: 2,\n        wood: 0,\n      },\n      speed: 1,\n    },\n    {\n      name: '水系史莱姆',\n      element: 'water',\n      HP: 470,\n      damage: 1,\n      resistance: {\n        normal: 0.8,\n        fire: 0,\n        water: 1,\n        wood: 2,\n      },\n      speed: 1.25,\n    },\n    {\n      name: '木系史莱姆',\n      element: 'wood',\n      HP: 190,\n      damage: 1,\n      resistance: {\n        normal: 0.8,\n        fire: 2,\n        water: 0,\n        wood: 1,\n      },\n      speed: 2.5,\n    },\n  ],\n  waves: [\n    {\n      element: 'normal',\n      enterTime: 600,\n      position: {\n        x: 1,\n        y: 1,\n      },\n    },\n    {\n      element: 'fire',\n      enterTime: 1000,\n      position: {\n        x: 2,\n        y: 1,\n      },\n    },\n    {\n      element: 'water',\n      enterTime: 1300,\n      position: {\n        x: 3,\n        y: 1,\n      },\n    },\n    {\n      element: 'wood',\n      enterTime: 1600,\n      position: {\n        x: 4,\n        y: 1,\n      },\n    },\n    {\n      element: 'normal',\n      enterTime: 2900,\n      position: {\n        x: 4,\n        y: 1,\n      },\n    },\n    {\n      element: 'water',\n      enterTime: 3000,\n      position: {\n        x: 5,\n        y: 1,\n      },\n    },\n    {\n      element: 'wood',\n      enterTime: 3300,\n      position: {\n        x: 5,\n        y: 1,\n      },\n    },\n    {\n      element: 'water',\n      enterTime: 3500,\n      position: {\n        x: 2,\n        y: 1,\n      },\n    },\n    {\n      element: 'fire',\n      enterTime: 4000,\n      position: {\n        x: 3,\n        y: 1,\n      },\n    },\n    {\n      element: 'normal',\n      enterTime: 4700,\n      position: {\n        x: 4,\n        y: 1,\n      },\n    },\n    {\n      element: 'wood',\n      enterTime: 6300,\n      position: {\n        x: 1,\n        y: 1,\n      },\n    },\n    {\n      element: 'normal',\n      enterTime: 6800,\n      position: {\n        x: 5,\n        y: 1,\n      },\n    },\n    {\n      element: 'water',\n      enterTime: 7500,\n      position: {\n        x: 4,\n        y: 1,\n      },\n    },\n    {\n      element: 'fire',\n      enterTime: 8000,\n      position: {\n        x: 2,\n        y: 1,\n      },\n    },\n  ],\n};\n\nexport const UserData: EVAGame.IGameData = {\n  baseDamage: {\n    ...GameData.baseDamage,\n  },\n  player: {\n    ...GameData.player,\n  },\n  map: {\n    ...GameData.map,\n  },\n  weapons: GameData.weapons.map((weapon) => ({\n    ...weapon,\n  })),\n  enemys: GameData.enemys.map((enemy) => ({\n    ...enemy,\n  })),\n  waves: GameData.waves.map((wave) => ({\n    ...wave,\n  })),\n};\n","import React from 'react';\nimport { EVAGame } from '../../eva-game-types';\nimport './index.css';\n\ninterface IWeaponComponentProps {\n  weapon: EVAGame.IWeapon;\n  onSelected: (element: EVAGame.element) => void;\n  selected: boolean;\n}\n\nexport default function Weapon({ weapon, onSelected, selected }: IWeaponComponentProps) {\n  const select = () => {\n    onSelected(weapon.element);\n  };\n\n  return (\n    <div className=\"weapon\" onClick={select}>\n      <div className={selected ? 'weapon_building_bg element-selected' : 'weapon_building_bg element-unselect'} />\n      <div className=\"weapon_building\">\n        <div className={`weapon_building_img element-${weapon.element}`} />\n      </div>\n      <div className={`weapon_badge element-badge-${weapon.element}`} />\n      <div className=\"level\">{`LV ${weapon.level}`}</div>\n    </div>\n  );\n}\n","import { useState } from 'react';\nimport { EVAGame } from '../../eva-game-types';\nimport './index.css';\n\ninterface IWeaponDetailComponentProps {\n  weapon: EVAGame.IWeapon;\n  restGold: number;\n  onLvChange: (cost: number) => void;\n  selected: boolean;\n}\n\nexport default function WeaponDetail({ weapon, selected, restGold, onLvChange }: IWeaponDetailComponentProps) {\n  const [level, setLevel] = useState(weapon.level);\n\n  const onDowngradeChange = () => {\n    if (weapon.level === 1) {\n      return;\n    }\n\n    weapon.level -=1\n    setLevel(weapon.level);\n    onLvChange(-weapon.cost);\n  };\n\n  const onUpgradeChange = () => {\n    if (restGold - weapon.cost < 0) {\n      return;\n    }\n\n    weapon.level += 1;\n    setLevel(weapon.level);\n    onLvChange(weapon.cost);\n  };\n\n  return (\n    <div className=\"weapon_card\" style={{ display: selected ? 'flex' : 'none' }}>\n      <div className=\"weapon_card-intro\">\n        <div className=\"weapon_card-img_wrap\">\n          <div className={`weapon_card-img element-${weapon.element}`}></div>\n          <div className={`weapon_card-badge element-badge-${weapon.element}`} />\n        </div>\n        <div className=\"weapon_card-upgrade_wrap\">\n          <div className=\"weapon_card-drowngrade\" onClick={onDowngradeChange}></div>\n          <div className=\"weapon_card-lv\">{`LV ${level}`}</div>\n          <div className=\"weapon_card-upgrade\" onClick={onUpgradeChange}></div>\n        </div>\n      </div>\n      <div className=\"weapon_card-body\">\n        <div className=\"weapon_card-title\">\n          <div className=\"weapon_card-name\">{`${weapon.name}`}</div>\n          <div className=\"weapon_card-cost_wrap\">\n            <div className=\"weapon_card-unit\"></div>\n            <div className=\"weapon_card-cost\">{`${weapon.cost}`}</div>\n          </div>\n        </div>\n        <div className=\"weapon_card-info\">{weapon.info}</div>\n      </div>\n    </div>\n  );\n}\n","import { useCallback, useState, memo } from 'react';\nimport { useHistory } from 'react-router-dom';\nimport { UserData } from '../../data';\nimport { EVAGame } from '../../eva-game-types';\nimport Weapon from '../../components/Weapon';\nimport WeaponDetail from '../../components/WeaponDetail';\nimport './index.css';\n\nfunction Home() {\n  const history = useHistory();\n\n  const [gold, setGold] = useState(UserData.player.Gold);\n\n  const [selectedWeapon, setSelectedWeapon] = useState(UserData.weapons[0].element);\n\n  const onWeaponSelect = useCallback((element: EVAGame.element) => {\n    setSelectedWeapon(element);\n  }, []);\n\n  const onWeaponLvChange = useCallback((cost: number) => {\n    UserData.player.Gold -= cost;\n    setGold(UserData.player.Gold);\n  }, []);\n\n  const onStart = () => {\n    history.push('/game');\n  };\n\n  return (\n    <div className=\"app\">\n      <div className=\"nav\">\n        <div className=\"gold\">{gold}</div>\n        <a href=\"https://eva.js.org/\" className=\"eva\">Eva.js</a>\n      </div>\n      <div className=\"weapons\">\n        {\n          UserData.weapons.map(weapon => (\n            <Weapon\n              weapon={weapon}\n              onSelected={onWeaponSelect}\n              selected={weapon.element === selectedWeapon}\n              key={weapon.element}\n            />\n          ))\n        }\n      </div>\n      <div className=\"separator\">\n        <div className=\"separator-img\"></div>\n      </div>\n      <div className=\"weapon-detail\">\n        {\n          UserData.weapons.map(weapon => (\n            <WeaponDetail\n              weapon={weapon}\n              restGold={gold}\n              onLvChange={onWeaponLvChange}\n              selected={weapon.element === selectedWeapon}\n              key={weapon.element}\n            />\n          ))\n        }\n      </div>\n      <div className=\"start\" onClick={onStart}></div>\n    </div>\n  );\n}\n\nexport default memo(Home);","import { EVAGame } from '../../eva-game-types';\nimport { Component, decorators, System } from '@eva/eva.js';\nimport { Text } from '@eva/plugin-renderer-text';\n\nexport type PlayerParams = EVAGame.IPlayer;\n\nexport class PlayerComponent extends Component {\n  static componentName = 'player';\n  healthPoint!: number;\n  gold!: number;\n\n  // eslint-disable-next-line\n  constructor(params: PlayerParams) {\n    super(params);\n  }\n\n  init({ HP, Gold }: PlayerParams) {\n    this.healthPoint = HP;\n    this.gold = Gold;\n  }\n}\n\n@decorators.componentObserver({\n  player: ['healthPoint'],\n})\nclass PlayerSystem extends System {\n  static systemName = 'system';\n\n  update() {\n    const conponentChanged = this.componentObserver.clear();\n\n    for (const changed of conponentChanged) {\n      const { gameObject, component } = changed;\n\n      if (gameObject && component instanceof PlayerComponent) {\n        const heartHpTransform = gameObject.transform.children.find(childTransform => childTransform.gameObject.name === 'player-hp');\n        const textComponent = heartHpTransform?.gameObject.getComponent(Text);\n\n        if (textComponent) {\n          textComponent.text = Math.max(component.healthPoint, 0) + '';\n        }\n\n        if (component.healthPoint <= 0) {\n          this.game.emit('result', { win: false });\n        }\n      }\n    }\n  }\n}\n\nexport { PlayerSystem };\n","import { Component } from '@eva/eva.js';\n\nexport function now() {\n  return typeof performance !== 'undefined' ? performance.now() >> 0 : Date.now();\n}\n\nexport class ClockComponent extends Component {\n  static componentName = 'clock';\n  private _startTime!: number;\n  level = 1;\n\n  get pastTime() {\n    return (now() - this._startTime) * this.level;\n  }\n\n  get startTime() {\n    return this._startTime;\n  }\n\n  awake() {\n    this._startTime = now();\n  }\n\n  repeat(fn: Parameters<typeof setInterval>[2], time: number) {\n    return setInterval(fn, time / this.level);\n  }\n\n  delay(time: number) {\n    return new Promise((resolve) => {\n      setTimeout(resolve, time / this.level);\n    });\n  }\n}\n","import { Component, decorators, System } from '@eva/eva.js';\nimport { ClockComponent, now } from './clock';\n\nexport class GameLogComponent extends Component {\n  static componentName = 'gamelog';\n  message!: [level: keyof Console, time: number, text: string][];\n\n  init() {\n    this.message = [];\n  }\n\n  add(logs: string[], level: keyof Console = 'debug') {\n    this.message = [\n      ...this.message,\n      [level, now(), [`@${this.gameObject.name}`, ...logs].join(' ')],\n    ];\n  }\n\n  info(...logs: string[]) {\n    this.add(logs, 'info');\n  }\n\n  debug(...logs: string[]) {\n    this.add(logs, 'debug');\n  }\n\n  error(...logs: string[]) {\n    this.add(logs, 'error');\n  }\n}\n\nfunction format(time: number) {\n  const m = Math.floor(time / 1000 / 60);\n  const s = Math.floor(time / 1000) % 60;\n  const mm = time % 1000;\n\n  return `${m.toString().padStart(2, '0')}.${s.toString().padStart(2, '0')}.${mm.toString().padStart(3, '0')}`;\n}\n\nexport interface LogSystemParams {}\n\n@decorators.componentObserver({\n  gamelog: ['message'],\n})\nclass GameLogSystem extends System {\n  static systemName = 'gamelog';\n\n  // eslint-disable-next-line\n  constructor(params?: LogSystemParams) {\n    super(params);\n  }\n\n  update() {\n    const componentChanged = this.componentObserver.clear();\n    const clockComponent = this.game.scene.getComponent(ClockComponent);\n\n    for (const changed of componentChanged) {\n      const { message } = changed.component as GameLogComponent;\n\n      for (const [level, time, text] of message) {\n        console[level](`[${format(time - clockComponent.startTime)}] ${text}`);\n      }\n\n      message.length = 0;\n    }\n  }\n}\n\nexport { GameLogSystem };\n","import { EVAGame } from '../../eva-game-types';\nimport { Component, System, decorators, GameObject } from '@eva/eva.js';\nimport { Graphics } from '@eva/plugin-renderer-graphics';\nimport { GameLogComponent } from './log';\n\nexport interface MapParams {\n  origin?: {\n    x?: number;\n    y?: number;\n  };\n  anchor?: {\n    x?: number;\n    y?: number;\n  };\n  position: {\n    x: number;\n    y: number;\n  };\n}\n\nexport class MapComponent extends Component {\n  static componentName = 'map';\n  transform!: MapParams;\n  x!: number;\n  y!: number;\n\n  // eslint-disable-next-line\n  constructor(params: MapParams) {\n    super(params);\n  }\n\n  init(transform: MapParams) {\n    this.transform = transform;\n    this.x = transform.position.x;\n    this.y = transform.position.y;\n  }\n}\n\nexport interface MapSystemParams extends EVAGame.IMap {\n  width: number;\n  height: number;\n  helper?: boolean;\n}\n\nexport interface MapGrid {\n  position: {\n    x: number;\n    y: number;\n  };\n}\n\n@decorators.componentObserver({\n  map: ['x', 'y'],\n})\nclass MapSystem extends System {\n  static systemName = 'map';\n\n  ceil: {\n    width: number;\n    height: number;\n  } = {\n    width: 0,\n    height: 0,\n  };\n  routeDistance!: number;\n  helper!: boolean;\n  grids: MapGrid[][] = [];\n\n  private width!: number;\n  private height!: number;\n  private column!: number;\n  private row!: number;\n\n  // eslint-disable-next-line\n  constructor(params: MapSystemParams) {\n    super(params);\n  }\n\n  init({\n    width,\n    height,\n    column,\n    row,\n    distance,\n    helper = false,\n  }: MapSystemParams) {\n    this.width = width;\n    this.height = height;\n    this.column = column;\n    this.row = row;\n    this.routeDistance = distance;\n    this.helper = helper;\n    this.ceil.width = Math.floor(width / column);\n    this.ceil.height = Math.floor(height / row);\n\n    for (let i = 0; i < row; i++) {\n      this.grids[i] = [];\n\n      for (let j = 0; j < column; j++) {\n        this.grids[i].push({\n          position: {\n            x: j * this.ceil.width,\n            y: i * this.ceil.height,\n          },\n        });\n      }\n    }\n  }\n\n  start() {\n    if (this.helper) {\n      const gridHelper = new GameObject('mapGridHelper', {\n        size: {\n          width: this.width,\n          height: this.height,\n        },\n      });\n\n      const gridLine = gridHelper.addComponent(new Graphics());\n      gridLine.graphics.lineStyle(2, 0xcccccc, 1);\n\n      for (let i = 0; i < this.row; i++) {\n        gridLine.graphics.moveTo(this.grids[i][0].position.x, this.grids[i][0].position.y);\n        gridLine.graphics.lineTo(this.grids[i][this.column - 1].position.x + this.ceil.width, this.grids[i][this.column - 1].position.y);\n      }\n\n      for (let j = 0; j < this.column; j++) {\n        gridLine.graphics.moveTo(this.grids[0][j].position.x, this.grids[0][j].position.y);\n        gridLine.graphics.lineTo(this.grids[this.row - 1][j].position.x, this.grids[this.row - 1][j].position.y + this.ceil.height);\n      }\n\n      this.game.scene.addChild(gridHelper);\n    }\n  }\n\n  update() {\n    const componentChanged = this.componentObserver.clear();\n\n    for (const changed of componentChanged) {\n      const { gameObject, component } = changed;\n\n      if (!gameObject) continue;\n\n      const logComponent = gameObject.getComponent(GameLogComponent);\n\n      if (component instanceof MapComponent && gameObject.transform) {\n        let { x, y } = this.grids[component.y - 1][component.x - 1].position;\n        x += this.ceil.width * (component.transform?.anchor?.x || 0);\n        y += this.ceil.height * (component.transform?.anchor?.y || 0);\n        x -= gameObject.transform.size.width * (component.transform?.origin?.x || 0);\n        y -= gameObject.transform.size.height * (component.transform?.origin?.y || 0);\n\n        gameObject.transform.position.x = x;\n        gameObject.transform.position.y = y;\n\n        logComponent.debug(`move to [${component.x}, ${component.y}]`);\n      }\n    }\n  }\n}\n\nexport { MapSystem };\n","import { EVAGame } from '../../eva-game-types';\nimport { Component, decorators, System } from '@eva/eva.js';\nimport { PlayerComponent } from './player';\n\nexport class WaveComponent extends Component {\n  static componentName = 'wave';\n  count = 0;\n}\n\n@decorators.componentObserver({\n  wave: ['count'],\n})\nclass WaveSystem extends System {\n  static systemName = 'wave';\n  waves!: EVAGame.IWave[];\n\n  // eslint-disable-next-line\n  constructor(params: EVAGame.IWave[]) {\n    super(params);\n  }\n\n  init(waves: EVAGame.IWave[]) {\n    this.waves = waves;\n  }\n\n  update() {\n    const componentChanged = this.componentObserver.clear();\n    let playComponent: PlayerComponent | undefined;\n\n    if (componentChanged.length > 0) {\n      playComponent = this.game.scene.gameObjects\n        .find((gameObject) => gameObject.name === 'player')\n        ?.getComponent(PlayerComponent);\n    }\n\n    for (const changed of componentChanged) {\n      const { component } = changed;\n\n      if (component instanceof WaveComponent) {\n        if (component.count >= this.waves.length) {\n          this.game.emit('result', {\n            win: playComponent && playComponent.healthPoint > 0,\n          });\n        }\n      }\n    }\n  }\n}\n\nexport { WaveSystem };\n","import { EVAGame } from '../../eva-game-types';\nimport { DragonBone } from '@eva/plugin-renderer-dragonbone';\nimport { Component, decorators, System } from '@eva/eva.js';\nimport { ClockComponent } from './clock';\nimport { GameLogComponent } from './log';\nimport { MapComponent, MapSystem } from './map';\nimport { PlayerComponent } from './player';\nimport { WaveComponent } from './wave';\nimport { Graphics } from '@eva/plugin-renderer-graphics';\n\nexport interface IEnemyResource {\n  color: number;\n}\n\nexport const EnemyResource: {\n  normal: IEnemyResource;\n  fire: IEnemyResource;\n  water: IEnemyResource;\n  wood: IEnemyResource;\n} = {\n  normal: {\n    color: 0x999999,\n  },\n  fire: {\n    color: 0xff0000,\n  },\n  water: {\n    color: 0x0000ff,\n  },\n  wood: {\n    color: 0x00ff00,\n  },\n};\n\nexport enum EnemyStatus {\n  idle = 0,\n  walking,\n  ending,\n  dead,\n  queen,\n}\n\nexport type EnemyParams = EVAGame.IEnemy;\n\nexport class EnemyComponent extends Component {\n  static componentName = 'enemy';\n  enemyName!: string;\n  element!: EVAGame.element;\n  healthPoint!: number;\n  HP!: number;\n  damage!: number;\n  resistance!: EVAGame.IElementalDamage;\n  speed!: number;\n  status: EnemyStatus = EnemyStatus.idle;\n  moving!: ReturnType<typeof setInterval>;\n  distance: number = 0;\n\n  // eslint-disable-next-line\n  constructor(params: EnemyParams) {\n    super(params);\n  }\n\n  init({ name, element, HP, damage, resistance, speed }: EnemyParams) {\n    this.enemyName = name;\n    this.element = element;\n    this.healthPoint = HP;\n    this.HP = HP;\n    this.damage = damage;\n    this.resistance = resistance;\n    this.speed = speed;\n  }\n\n  onDestroy() {\n    clearInterval(this.moving);\n  }\n\n  enter() {\n    this.status = EnemyStatus.walking;\n    const animi = this.gameObject.getComponent(DragonBone);\n    animi.play('newAnimation');\n\n    this.distance = 0;\n  }\n\n  move() {\n    const clockComponent = this.gameObject.scene.getComponent(ClockComponent);\n    this.moving = clockComponent.repeat(() => {\n      if (this.status === EnemyStatus.walking) {\n        this.distance += 1;\n      }\n    }, 1000 / this.speed);\n  }\n\n  die() {\n    clearInterval(this.moving);\n    this.status = EnemyStatus.dead;\n  }\n\n  victory() {\n    clearInterval(this.moving);\n    this.status = EnemyStatus.queen;\n  }\n}\n\nexport interface EnemySystemParams {}\n\n@decorators.componentObserver({\n  enemy: ['distance', 'healthPoint'],\n})\nclass EnemySystem extends System {\n  static systemName = 'enemy';\n\n  // eslint-disable-next-line\n  constructor(params?: EnemySystemParams) {\n    super(params);\n  }\n\n  update() {\n    const componentChanged = this.componentObserver.clear();\n    let mapSystem: MapSystem | undefined;\n    let waveComponent: WaveComponent | undefined;\n    let playerComponent: PlayerComponent | undefined;\n\n    if (componentChanged.length > 0) {\n      mapSystem = this.game.getSystem(MapSystem) as MapSystem;\n      waveComponent = this.game.scene.getComponent(WaveComponent);\n      playerComponent = this.game.scene.gameObjects\n        .find((gameObject) => gameObject.name === 'player')\n        ?.getComponent(PlayerComponent);\n    }\n\n\n    for (const changed of componentChanged) {\n      const { gameObject, component } = changed;\n      const props = changed.prop?.prop || [];\n\n      if (!gameObject) continue;\n\n      const mapComponent = gameObject.getComponent(MapComponent);\n      const gameLogComponent = gameObject.getComponent(GameLogComponent);\n\n      if (component instanceof EnemyComponent) {\n        for (const propName of props) {\n          switch (propName) {\n            case 'distance': {\n              if (mapSystem && component.distance >= mapSystem.routeDistance) {\n                if (component.healthPoint > 0) {\n                  if (playerComponent) {\n                    playerComponent.healthPoint -= component.damage;\n                    gameLogComponent?.debug(`attack Player with ${component.damage}HP`);\n                  }\n\n                  if (waveComponent) {\n                    waveComponent.count += 1;\n                  }\n\n                  component.victory();\n                  gameObject.destroy();\n                }\n              } else {\n                mapComponent.y = mapComponent.transform.position.y + component.distance;\n              }\n              break;\n            }\n            case 'healthPoint': {\n              gameLogComponent?.debug(`left ${component.healthPoint}HP`);\n\n              if (component.healthPoint <= 0) {\n                if (waveComponent) {\n                  waveComponent.count += 1;\n                }\n\n                component.die();\n                gameObject.destroy();\n              } else {\n                const healthBarTransform = gameObject?.transform?.children.find(child => child.gameObject.name === 'health-bar');\n                const healthBarGraphic = healthBarTransform?.gameObject?.getComponent(Graphics);\n\n                if (healthBarGraphic) {\n                  const healthPointWidth = Math.floor(Math.max(10, (component.healthPoint / component.HP) * 150));\n                  healthBarGraphic.graphics.clear();\n                  healthBarGraphic.graphics.beginFill(0xde3249, 1);\n                  healthBarGraphic.graphics.drawRoundedRect(0, 0, healthPointWidth, 24, 9);\n                  healthBarGraphic.graphics.endFill();\n                }\n              }\n              break;\n            }\n          }\n        }\n      }\n    }\n  }\n}\n\nexport { EnemySystem };\n","import { EVAGame } from '../../eva-game-types';\nimport { Component, decorators, GameObject, System } from '@eva/eva.js';\nimport { Event } from '@eva/plugin-renderer-event';\nimport { ClockComponent } from './clock';\nimport { EnemyComponent } from './enemy';\nimport { GameLogComponent } from './log';\n\nexport type WeaponParams = Exclude<EVAGame.IWeapon, 'cost' | 'info'>;\n\nexport class WeaponComponent extends Component {\n  static componentName = 'weapon';\n  weaponName!: string;\n  level!: number;\n  element!: EVAGame.element;\n  damage!: EVAGame.IElementalDamage;\n  cd!: number;\n  delay!: number;\n  attackCount!: number;\n  attacking!: ReturnType<typeof setInterval>;\n\n  // eslint-disable-next-line\n  constructor(params: WeaponParams) {\n    super(params);\n  }\n\n  init({\n    name,\n    level = 1,\n    element,\n    damage,\n    cd,\n    delay,\n  }: WeaponParams) {\n    this.weaponName = name;\n    this.level = level;\n    this.element = element;\n    this.damage = damage;\n    this.cd = cd;\n    this.delay = delay;\n    this.attackCount = 0;\n  }\n\n  multiDamge(a: EVAGame.IElementalDamage, b: EVAGame.IElementalDamage, level = 1): EVAGame.IElementalDamage {\n    return {\n      normal: Math.round(a.normal * b.normal * level),\n      fire: Math.round(a.fire * b.fire * level),\n      water: Math.round(a.water * b.water * level),\n      wood: Math.round(a.wood * b.wood * level),\n    };\n  }\n\n  sumDamange(a: EVAGame.IElementalDamage): number {\n    return a.normal + a.fire + a.water + a.wood;\n  }\n\n  attack() {\n    const clockComponent = this.gameObject.scene.getComponent(ClockComponent);\n\n    clockComponent.delay(this.delay)\n      .then(() => {\n        this.attacking = clockComponent.repeat(() => {\n          this.attackCount += 1;\n          this.emit('attack');\n        }, this.cd);\n      });\n  }\n\n  onDestroy() {\n    clearInterval(this.attackCount);\n  }\n}\n\n@decorators.componentObserver({\n  weapon: ['attackCount'],\n})\nclass WeaponSystem extends System {\n  static systemName = 'weapon';\n  baseDamage!: EVAGame.IElementalDamage;\n\n  // eslint-disable-next-line\n  constructor(params: EVAGame.IElementalDamage) {\n    super(params);\n  }\n\n  init(params: EVAGame.IElementalDamage) {\n    this.baseDamage = params;\n  }\n\n  update() {\n    const componentChanged = this.componentObserver.clear();\n    let enemys: GameObject[] = [];\n\n    if (componentChanged.length > 0) {\n      enemys = this.game.scene.gameObjects.filter((gameObject) => !!gameObject.getComponent(EnemyComponent));\n    }\n\n    for (const changed of componentChanged) {\n      const { component, gameObject } = changed;\n\n      if (!gameObject) continue;\n\n      const logComponent = gameObject.getComponent(GameLogComponent);\n      const eventComponent = gameObject.getComponent(Event);\n\n      if (component instanceof WeaponComponent && component.attackCount > 0) {\n        const damage = component.multiDamge(this.baseDamage, component.damage, component.level);\n        eventComponent.emit('playIdle', 1);\n\n        for (const enemy of enemys) {\n          const enemyComponet = enemy.getComponent(EnemyComponent);\n          const realDamage = component.sumDamange(component.multiDamge(damage, enemyComponet.resistance));\n          enemyComponet.healthPoint -= realDamage;\n          logComponent.debug(`attack @${enemy.name} with ${realDamage} HP`);\n        }\n      }\n    }\n  }\n}\n\nexport { WeaponSystem };\n","import { GameObject, RESOURCE_TYPE, resource } from '@eva/eva.js';\nimport { Graphics } from '@eva/plugin-renderer-graphics';\nimport { DragonBone } from '@eva/plugin-renderer-dragonbone';\nimport { Event } from '@eva/plugin-renderer-event';\nimport { Text } from '@eva/plugin-renderer-text';\nimport { Img } from '@eva/plugin-renderer-img';\nimport { Render } from '@eva/plugin-renderer-render';\nimport { Transition } from '@eva/plugin-transition';\nimport { EVAGame } from '../eva-game-types';\nimport { PlayerComponent } from './components/player';\nimport { WeaponComponent } from './components/weapon';\nimport { EnemyComponent } from './components/enemy';\nimport { MapComponent } from './components/map';\nimport { GameLogComponent } from './components/log';\n\ninterface GraphicResource {\n  color: number;\n  shape: 'rect' | 'star' | 'circle';\n}\n\ninterface ImageResource {\n  name: string;\n  type: RESOURCE_TYPE.IMAGE;\n  src: {\n    image: {\n      type: 'png';\n      url: string;\n    };\n  };\n  preload: boolean;\n}\ninterface DragonBoneResource {\n  name: string;\n  type: RESOURCE_TYPE.DRAGONBONE;\n  src: {\n    image: {\n      type: 'png';\n      url: string;\n    };\n    tex: {\n      type: 'json';\n      url: string;\n    };\n    ske: {\n      type: 'json';\n      url: string;\n    };\n  };\n  preload: boolean;\n}\n\ninterface ICreateParams {\n  name: string;\n  width?: number;\n  height?: number;\n  scale?: number;\n  x: number;\n  y: number;\n  graphic?: GraphicResource;\n  image?: {\n    resource: string;\n  };\n  dragonebone?: {\n    resource: string;\n    armatureName: string;\n    animationName: string;\n  };\n}\n\ninterface IPrefabParams<T> {\n  data: T;\n  x: number;\n  y: number;\n}\n\nfunction createGameObject({\n  name,\n  width = 0,\n  height = 0,\n  scale = 1,\n  x,\n  y,\n  graphic,\n  image,\n  dragonebone,\n}: ICreateParams): GameObject {\n  const gameObject = new GameObject(name, {\n    size: {\n      width,\n      height,\n    },\n    scale: {\n      x: scale,\n      y: scale,\n    },\n  });\n\n  const event = gameObject.addComponent(new Event());\n\n  gameObject.addComponent(new GameLogComponent());\n\n  gameObject.addComponent(\n    new MapComponent({\n      anchor: {\n        x: 0.5,\n        y: 0.5,\n      },\n      origin: {\n        x: 0.5,\n        y: 0.5,\n      },\n      position: {\n        x,\n        y,\n      },\n    }),\n  );\n\n  if (graphic) {\n    const box = gameObject.addComponent(new Graphics());\n    box.graphics.beginFill(graphic.color, 1);\n    switch (graphic.shape) {\n      case 'rect': {\n        box.graphics.drawRect(0, 0, width, height);\n        break;\n      }\n      case 'circle': {\n        box.graphics.drawCircle(width / 2, height / 2, width / 2);\n        break;\n      }\n      case 'star': {\n        box.graphics.drawStar(width / 2, height / 2, 5, width / 2);\n        break;\n      }\n    }\n    box.graphics.endFill();\n  }\n\n  if (image) {\n    gameObject.addComponent(\n      new Img({\n        resource: image.resource,\n      }),\n    );\n  }\n\n  if (dragonebone) {\n    const anime = gameObject.addComponent(\n      new DragonBone({\n        resource: dragonebone.resource,\n        armatureName: dragonebone.armatureName,\n        autoPlay: false,\n      }),\n    );\n\n    event.on('playIdle', (times = 1) => {\n      anime.play(dragonebone.animationName, times);\n    });\n  }\n\n  return gameObject;\n}\n\nconst playerResource: (DragonBoneResource | ImageResource)[] = [{\n  name: 'player',\n  type: RESOURCE_TYPE.DRAGONBONE,\n  src: {\n    image: {\n      type: 'png',\n      url: './assets/dragonbone/robot/TB13RfXrwgP7K4jSZFqXXamhVXa-256-256.png',\n    },\n    tex: {\n      type: 'json',\n      url: './assets/dragonbone/robot/649a2382b6e70d4d3d9096301e1e9b0e.json',\n    },\n    ske: {\n      type: 'json',\n      url: './assets/dragonbone/robot/9f25675eaad7275307f4969cbad4fe99.json',\n    },\n  },\n  preload: true,\n},{\n  name: 'player-heart',\n  type: RESOURCE_TYPE.IMAGE,\n  src: {\n    image: {\n      type: 'png',\n      url: './assets/image/heart.png',\n    },\n  },\n  preload: true\n}];\n\nexport function player({ data, x, y }: IPrefabParams<EVAGame.IPlayer>): GameObject {\n  const gameObject = createGameObject({\n    name: 'player',\n    x,\n    y,\n    scale: 0.5,\n    dragonebone: {\n      resource: 'player',\n      armatureName: 'robot',\n      animationName: 'newAnimation',\n    },\n  });\n  gameObject.addComponent(new PlayerComponent(data));\n\n  const heart = new GameObject('player-heart', {\n    size: {\n      width: 60,\n      height: 60,\n    },\n    origin: {\n      x: 0.5,\n      y: 0.5,\n    },\n    position: {\n      x: -20,\n      y: -240,\n    }\n  });\n\n  heart.addComponent(new Img({\n    resource: 'player-heart'\n  }));\n\n  const hp = new GameObject('player-hp', {\n    origin: {\n      x: 0.5,\n      y: 0.5,\n    },\n    position: {\n      x: 50,\n      y: -240\n    }\n  });\n\n  hp.addComponent(new Text({\n    text: data.HP,\n    style: {\n      fontSize: 60,\n      fill: 0xD81E06,\n      stroke: 0xffffff,\n      strokeThickness: 10,\n    }\n  }));\n\n  gameObject.addChild(heart);\n  gameObject.addChild(hp);\n\n  return gameObject;\n}\n\nconst weaponResources: DragonBoneResource[] = [\n  {\n    name: 'normal-weapon',\n    type: RESOURCE_TYPE.DRAGONBONE,\n    src: {\n      image: {\n        type: 'png',\n        url: './assets/dragonbone/normal-weapon/TB1D1mM4Lb2gK0jSZK9XXaEgFXa-256-256.png',\n      },\n      tex: {\n        type: 'json',\n        url: './assets/dragonbone/normal-weapon/53f7268e6db5a0d8aa7765e721d6c50c.json',\n      },\n      ske: {\n        type: 'json',\n        url: './assets/dragonbone/normal-weapon/6a0de7df81565d7eeee74a7a5d5c90a2.json',\n      },\n    },\n    preload: true,\n  },\n  {\n    name: 'fire-weapon',\n    type: RESOURCE_TYPE.DRAGONBONE,\n    src: {\n      image: {\n        type: 'png',\n        url: './assets/dragonbone/fire-weapon/TB1Y65H4KL2gK0jSZPhXXahvXXa-256-256.png',\n      },\n      tex: {\n        type: 'json',\n        url: './assets/dragonbone/fire-weapon/2d18bc3f44529c8bb0745230b2008331.json',\n      },\n      ske: {\n        type: 'json',\n        url: './assets/dragonbone/fire-weapon/bf59a0d33ba196fdf17401cc2ff35d04.json',\n      },\n    },\n    preload: true,\n  },\n  {\n    name: 'water-weapon',\n    type: RESOURCE_TYPE.DRAGONBONE,\n    src: {\n      image: {\n        type: 'png',\n        url: './assets/dragonbone/water-weapon/TB1zsuL4Uz1gK0jSZLeXXb9kVXa-256-256.png',\n      },\n      tex: {\n        type: 'json',\n        url: './assets/dragonbone/water-weapon/fcc75c846bc10c6631a282218cbb77e4.json',\n      },\n      ske: {\n        type: 'json',\n        url: './assets/dragonbone/water-weapon/469a8af43daec65b35d9d9a0a257a472.json',\n      },\n    },\n    preload: true,\n  },\n  {\n    name: 'wood-weapon',\n    type: RESOURCE_TYPE.DRAGONBONE,\n    src: {\n      image: {\n        type: 'png',\n        url: './assets/dragonbone/wood-weapon/TB12teOt_M11u4jSZPxXXahcXXa-256-256.png',\n      },\n      tex: {\n        type: 'json',\n        url: './assets/dragonbone/wood-weapon/42726fc745c6e3c227a9c8d28865d49d.json',\n      },\n      ske: {\n        type: 'json',\n        url: './assets/dragonbone/wood-weapon/6bad23c6f2966b0c952a95cb2fdce202.json',\n      },\n    },\n    preload: true,\n  },\n];\n\nconst weaponArmatures = {\n  normal: 'slimer_nor',\n  fire: 'tower_fire',\n  water: 'arms-water',\n  wood: 'weapon_mu',\n};\n\nexport function weapon({ data, x, y }: IPrefabParams<EVAGame.IWeapon>): GameObject {\n  const gameObject = createGameObject({\n    name: `${data.element}-weapon`,\n    scale: 0.7,\n    x,\n    y,\n    dragonebone: {\n      resource: `${data.element}-weapon`,\n      armatureName: weaponArmatures[data.element],\n      animationName: 'newAnimation',\n    },\n  });\n  gameObject.addComponent(new WeaponComponent(data));\n\n  const text = new GameObject(`${data.element}-weapon`, {\n    position: {\n      x: 0,\n      y: 120,\n    },\n    origin: {\n      x: 0.5,\n      y: 0.5,\n    },\n  });\n\n  text.addComponent(\n    new Text({\n      text: `LV ${data.level}`,\n      style: {\n        fontSize: 40,\n        fill: 0xffffff,\n      },\n    }),\n  );\n\n  gameObject.addChild(text);\n\n  return gameObject;\n}\n\nconst bulletResources: ImageResource[] = [\n  {\n    name: 'normal-bullet',\n    type: RESOURCE_TYPE.IMAGE,\n    src: {\n      image: {\n        type: 'png',\n        url: './assets/image/normal-bullet.png',\n      },\n    },\n    preload: true,\n  },\n  {\n    name: 'fire-bullet',\n    type: RESOURCE_TYPE.IMAGE,\n    src: {\n      image: {\n        type: 'png',\n        url: './assets/image/fire-bullet.png',\n      },\n    },\n    preload: true,\n  },\n  {\n    name: 'water-bullet',\n    type: RESOURCE_TYPE.IMAGE,\n    src: {\n      image: {\n        type: 'png',\n        url: './assets/image/water-bullet.png',\n      },\n    },\n    preload: true,\n  },\n  {\n    name: 'wood-bullet',\n    type: RESOURCE_TYPE.IMAGE,\n    src: {\n      image: {\n        type: 'png',\n        url: './assets/image/wood-bullet.png',\n      },\n    },\n    preload: true,\n  },\n];\n\nexport function bullet({ data, x, y }: IPrefabParams<{ element: EVAGame.element }>): GameObject {\n  const gameObject = createGameObject({\n    name: `${data.element}-weapon`,\n    width: 750,\n    height: 1334,\n    x,\n    y,\n    image: {\n      resource: `${data.element}-bullet`,\n    },\n  });\n\n  const render = gameObject.addComponent(\n    new Render({\n      alpha: 0,\n    }),\n  );\n\n  gameObject.removeComponent(MapComponent);\n\n  const animation = gameObject.addComponent(new Transition());\n\n  animation.group = {\n    fire: [\n      {\n        name: 'alpha',\n        component: render,\n        values: [\n          {\n            time: 0,\n            value: 0,\n            tween: 'ease-in',\n          },\n          {\n            time: 50,\n            value: 1,\n            tween: 'linear',\n          },\n          {\n            time: 350,\n            value: 1,\n            tween: 'ease-out',\n          },\n          {\n            time: 400,\n            value: 0,\n          },\n        ],\n      },\n      {\n        name: 'position.y',\n        component: gameObject.transform,\n        values: [\n          {\n            time: 0,\n            value: 300,\n            tween: 'ease-out',\n          },\n          {\n            time: 400,\n            value: -100,\n          },\n        ],\n      },\n    ],\n  };\n\n  const event = gameObject.getComponent(Event);\n\n  event.on('fire', (times = 1) => {\n    animation.play('fire', times);\n    animation.once('finish', () => event.emit('fireend'));\n  });\n\n  return gameObject;\n}\n\nconst enemyResources: (DragonBoneResource | ImageResource)[] = [\n  {\n    name: 'normal-enemy',\n    type: RESOURCE_TYPE.DRAGONBONE,\n    src: {\n      image: {\n        type: 'png',\n        url: './assets/dragonbone/enemy-normal/TB1XrNR4UY1gK0jSZFMXXaWcVXa-256-256.png',\n      },\n      tex: {\n        type: 'json',\n        url: './assets/dragonbone/enemy-normal/86d3a8d59acaf29d24c8db90a8c2113e.json',\n      },\n      ske: {\n        type: 'json',\n        url: './assets/dragonbone/enemy-normal/c8c2a5ab1f07ec118d8341770b025377.json',\n      },\n    },\n    preload: true,\n  },\n  {\n    name: 'water-enemy',\n    type: RESOURCE_TYPE.DRAGONBONE,\n    src: {\n      image: {\n        type: 'png',\n        url: './assets/dragonbone/enemy-water/TB155BQ4FT7gK0jSZFpXXaTkpXa-256-256.png',\n      },\n      tex: {\n        type: 'json',\n        url: './assets/dragonbone/enemy-water/9e750ffd7a4e22de9a1b07f2c2d647be.json',\n      },\n      ske: {\n        type: 'json',\n        url: './assets/dragonbone/enemy-water/d54d187987edd2f9301a0954b0457673.json',\n      },\n    },\n    preload: true,\n  },\n  {\n    name: 'fire-enemy',\n    type: RESOURCE_TYPE.DRAGONBONE,\n    src: {\n      image: {\n        type: 'png',\n        url: './assets/dragonbone/enemy-fire/TB1xcFzqQcx_u4jSZFlXXXnUFXa-256-256.png',\n      },\n      tex: {\n        type: 'json',\n        url: './assets/dragonbone/enemy-fire/9aa0f6c67e7f4b674ecbdd14d6261434.json',\n      },\n      ske: {\n        type: 'json',\n        url: './assets/dragonbone/enemy-fire/9f628e03da2e9ee5f441d496d68167e0.json',\n      },\n    },\n    preload: true,\n  },\n  {\n    name: 'wood-enemy',\n    type: RESOURCE_TYPE.DRAGONBONE,\n    src: {\n      image: {\n        type: 'png',\n        url: './assets/dragonbone/enemy-wood/TB1sbpZ4UY1gK0jSZFCXXcwqXXa-256-256.png',\n      },\n      tex: {\n        type: 'json',\n        url: './assets/dragonbone/enemy-wood/8c54ab67e9abdb571749403a51b0f3e1.json',\n      },\n      ske: {\n        type: 'json',\n        url: './assets/dragonbone/enemy-wood/deb0c3308470969e2fd6a455be4fb368.json',\n      },\n    },\n    preload: true,\n  },\n  {\n    name: 'normal-enemy-badge',\n    type: RESOURCE_TYPE.IMAGE,\n    src: {\n      image: {\n        type: 'png',\n        url: './assets/image/element_badge_normal.png',\n      },\n    },\n    preload: true,\n  },\n  {\n    name: 'fire-enemy-badge',\n    type: RESOURCE_TYPE.IMAGE,\n    src: {\n      image: {\n        type: 'png',\n        url: './assets/image/element_badge_fire.png',\n      },\n    },\n    preload: true,\n  },\n  {\n    name: 'water-enemy-badge',\n    type: RESOURCE_TYPE.IMAGE,\n    src: {\n      image: {\n        type: 'png',\n        url: './assets/image/element_badge_water.png',\n      },\n    },\n    preload: true,\n  },\n  {\n    name: 'wood-enemy-badge',\n    type: RESOURCE_TYPE.IMAGE,\n    src: {\n      image: {\n        type: 'png',\n        url: './assets/image/element_badge_wood.png',\n      },\n    },\n    preload: true,\n  },\n];\n\nconst enemyConfig = {\n  normal: {\n    scale: 0.6,\n    armatureName: 'slimer_mu',\n  },\n  fire: {\n    scale: 0.5,\n    armatureName: 'slimer_fire',\n  },\n  water: {\n    scale: 0.6,\n    armatureName: 'slimer_water',\n  },\n  wood: {\n    scale: 0.45,\n    armatureName: 'slimer_mu-01',\n  },\n}\n\nexport function enemy({ data, x, y }: IPrefabParams<EVAGame.IEnemy>): GameObject {\n  const config = enemyConfig[data.element];\n\n  const gameObject = createGameObject({\n    name: `${data.element}-enemy`,\n    scale: config.scale,\n    x,\n    y,\n    dragonebone: {\n      resource: `${data.element}-enemy`,\n      armatureName: config.armatureName,\n      animationName: 'newAnimation',\n    },\n  });\n\n  gameObject.addComponent(new EnemyComponent(data));\n\n  const badge = new GameObject('badge', {\n    size: {\n      width: 60,\n      height: 60,\n    },\n    position: {\n      x: -80,\n      y: -120,\n    },\n    origin: {\n      x: 0.5,\n      y: 0.5,\n    },\n  });\n  badge.addComponent(\n    new Img({\n      resource: `${data.element}-enemy-badge`,\n    }),\n  );\n\n  const healthBarBorder = new GameObject('health-bar-border', {\n    position: {\n      x: 20,\n      y: -120,\n    },\n    origin: {\n      x: 0.5,\n      y: 0.5,\n    },\n    size: {\n      width: 160,\n      height: 32,\n    },\n  });\n  const healthBarBorderGraphc = healthBarBorder.addComponent(new Graphics());\n  healthBarBorderGraphc.graphics.beginFill(0xffffff, 1);\n  healthBarBorderGraphc.graphics.drawRoundedRect(0, 0, 160, 32, 12);\n  healthBarBorderGraphc.graphics.endFill();\n\n  const healthBar = new GameObject('health-bar', {\n    position: {\n      x: -60,\n      y: -132,\n    },\n    size: {\n      width: 150,\n      height: 24,\n    },\n  });\n  const healthBarGraphic = healthBar.addComponent(new Graphics());\n  healthBarGraphic.graphics.beginFill(0xde3249, 1);\n  healthBarGraphic.graphics.drawRoundedRect(0, 0, 150, 24, 9);\n  healthBarGraphic.graphics.endFill();\n\n  gameObject.addChild(badge);\n  gameObject.addChild(healthBarBorder);\n  gameObject.addChild(healthBar);\n\n  return gameObject;\n}\n\nresource.addResource([\n  ...playerResource,\n  ...weaponResources,\n  ...enemyResources,\n  ...bulletResources\n]);\n\nresource.preload();\n","import { EVAGame } from '../eva-game-types';\nimport { Game, GameObject } from '@eva/eva.js';\nimport { RendererSystem } from '@eva/plugin-renderer';\nimport { GraphicsSystem } from '@eva/plugin-renderer-graphics';\nimport { DragonBoneSystem } from '@eva/plugin-renderer-dragonbone';\nimport { Event, EventSystem } from '@eva/plugin-renderer-event';\nimport { TextSystem } from '@eva/plugin-renderer-text';\nimport { ImgSystem } from '@eva/plugin-renderer-img';\nimport { RenderSystem } from '@eva/plugin-renderer-render';\nimport { TransitionSystem } from '@eva/plugin-transition';\nimport { PlayerSystem } from './components/player';\nimport { WeaponComponent, WeaponSystem } from './components/weapon';\nimport { EnemySystem, EnemyComponent } from './components/enemy';\nimport { MapSystem } from './components/map';\nimport { WaveSystem, WaveComponent } from './components/wave';\n// import { GameLogSystem } from './components/log';\nimport { ClockComponent } from './components/clock';\nimport * as prefab from './prefab';\n\nexport default class GameScript {\n  userData: EVAGame.IGameData;\n  game!: Game;\n  player!: GameObject;\n  enemys: GameObject[] = [];\n  weapons: GameObject[] = [];\n\n  constructor(userData: EVAGame.IGameData) {\n    this.userData = userData;\n  }\n\n  private initGame(canvasEl: HTMLCanvasElement) {\n    const canvasWidth = canvasEl.offsetWidth;\n    const canvasHeight = canvasEl.offsetHeight;\n    const sceneWidth = 750;\n    const sceneHeight = canvasHeight / canvasWidth * 750;\n\n    this.game = new Game(({\n      frameRate: 60,\n      autoStart: false,\n      systems: [\n        new WeaponSystem(this.userData.baseDamage),\n        new EnemySystem(),\n        new WaveSystem(this.userData.waves),\n        new PlayerSystem(),\n        new MapSystem({\n          // helper: true,\n          width: sceneWidth,\n          height: sceneHeight,\n          ...this.userData.map,\n        }),\n        // new GameLogSystem(),\n        new RendererSystem({\n          canvas: canvasEl,\n          width: sceneWidth,\n          height: sceneHeight,\n          transparent: true,\n          resoution: 0.5,\n        }),\n        new TextSystem(),\n        new EventSystem(),\n        new GraphicsSystem(),\n        new DragonBoneSystem(),\n        new ImgSystem(),\n        new TransitionSystem(),\n        new RenderSystem(),\n      ],\n    }));\n  }\n\n  private addPlayer() {\n    this.player = prefab.player({\n      data: this.userData.player,\n      ...this.userData.player.position,\n    });\n\n    const event = this.player.getComponent(Event);\n    event.emit('playIdle', Infinity);\n\n    this.game.scene.addChild(this.player);\n  }\n\n  private addWeapons() {\n    for (const data of this.userData.weapons) {\n      const weapon = prefab.weapon({\n        data,\n        ...data.position,\n      });\n      this.game.scene.addChild(weapon);\n      this.weapons.push(weapon);\n    }\n  }\n\n  private initScene() {\n    this.addPlayer();\n    this.addWeapons();\n    this.game.scene.addComponent(new ClockComponent());\n    this.game.scene.addComponent(new WaveComponent());\n  }\n\n  init(canvasEl: HTMLCanvasElement) {\n    this.initGame(canvasEl);\n    this.initScene();\n  }\n\n  private addEnemy(element: EVAGame.IEnemy['element'], position: {x: number, y: number}) {\n    const data = this.userData.enemys.find((enemy) => enemy.element === element);\n\n    if (data) {\n      const enemy = prefab.enemy({\n        data,\n        ...position,\n      });\n      this.game.scene.addChild(enemy);\n      return enemy;\n    }\n\n    return undefined;\n  }\n\n  private async startWave() {\n    const clockComponent = this.game.scene.getComponent(ClockComponent);\n\n    for (const { element, enterTime, position } of this.userData.waves) {\n      const { pastTime } = clockComponent;\n\n      if (pastTime < enterTime) {\n        await clockComponent.delay(enterTime - pastTime);\n      }\n\n      const enemy = this.addEnemy(element, position);\n\n      if (enemy) {\n        this.enemys.push(enemy);\n\n        const enemyComponent = enemy.getComponent(EnemyComponent);\n        enemyComponent.enter();\n        enemyComponent.move();\n      }\n    }\n  }\n\n  private async startAttack() {\n    for (const weapon of this.weapons) {\n      const weaponComponent = weapon.getComponent(WeaponComponent);\n      weaponComponent.on('attack', () => this.attackEffect(weaponComponent.element))\n      weaponComponent.attack();\n    }\n  }\n\n  private async attackEffect(element: EVAGame.element) {\n    const bullet = prefab.bullet({\n      data: {\n        element,\n      },\n      x: 3,\n      y: 10\n    });\n\n    this.game.scene.addChild(bullet);\n\n    const event = bullet.getComponent(Event);\n    event.on('fireend', () => bullet.remove());\n    event.emit('fire', 1);\n  }\n\n  start() {\n    this.game.start();\n    this.startWave();\n    this.startAttack();\n  }\n\n  onEnd(fn: (result: any) => void) {\n    this.game.once('result', fn);\n  }\n\n  pause() {\n    this.game.pause();\n  }\n\n  destory() {\n    this.game.destroy();\n  }\n}","import { useCallback } from 'react';\nimport './index.css';\n\ninterface IResultProps {\n  result: any;\n}\n\nexport default function Result({result}: IResultProps) {\n\n  const reset = useCallback(() => {\n    window.location.replace(`?t=${Date.now()}`);\n  }, []);\n\n  if (result === null) {\n    return null;\n  }\n\n  return (\n    <div className=\"result\">\n        <div className=\"text\">\n          <div className=\"title\">\n            {\n              result?.win ? \n                <div className=\"win\"><h2>You <b>Win!</b></h2></div>\n                :\n                <div className=\"lose\">\n                  <h2>You <b>Lose!</b></h2>\n                  <span>可以调整塔的级别试试哦！</span>\n                </div>\n            } \n          </div>\n          <div className=\"staff\">\n            <ul>\n              <li><i className=\"icon normal-weapon-icon \" /><b>策划：</b><i>齐纪</i></li>\n              <li><i className=\"icon fire-weapon-icon\" /><b>产品：</b><i>眀非</i></li>\n              <li><i className=\"icon water-weapon-icon\" /><b>产品：</b><i>蕴光</i></li>\n              <li><i className=\"icon wood-weapon-icon\" /><b>数值：</b><i>光驰</i></li>\n              <li><i className=\"icon eva-icon\" /><b>质量：</b><i>以顺</i></li>\n            </ul>\n            <ul>\n              <li><i className=\"icon normal-enemy-icon\" /><b>原画：</b><i>夜翎</i></li>\n              <li><i className=\"icon fire-enemy-icon\" /><b>美术：</b><i>异铭</i></li>\n              <li><i className=\"icon water-enemy-icon\" /><b>程序：</b><i>渚薰</i></li>\n              <li><i className=\"icon wood-enemy-icon\" /><b>程序：</b><i>宵乐</i></li>\n            </ul>\n          </div>\n          <h3><i className=\"icon brand-icon\" /><a href=\"https://www.yuque.com/eva/blog/intro\">淘系互动@copyright</a></h3>\n        </div>\n        <div className=\"button\" onClick={reset}>RESTART</div>\n      </div>\n  )\n}","import { useEffect, useRef, useState, memo } from 'react';\nimport { UserData } from '../../data';\nimport GameScript from '../../scripts/game';\nimport Result from '../../components/Result';\nimport './index.css';\n\nfunction Game() {\n  const [result, setResult] = useState<any>(null);\n  const canvasEl = useRef<HTMLCanvasElement>(null);\n\n  useEffect(() => {\n    let game: GameScript;\n\n    if (canvasEl.current) {\n      game = new GameScript(UserData);\n      game.init(canvasEl.current);\n      game.start();\n      game.onEnd(setResult);\n    }\n\n    return () => game?.destory();\n  }, []);\n\n  return (\n    <div className=\"game\">\n      <canvas ref={canvasEl} />\n      <Result result={result} />\n    </div>\n  );\n}\n\nexport default memo(Game);","import React from 'react';\nimport {\n  HashRouter as Router,\n  Switch,\n  Route,\n} from \"react-router-dom\";\nimport Home from './pages/Home';\nimport Game from './pages/Game';\nimport './App.css';\n\nfunction App() {\n  return (\n    <Router>\n      <Switch>\n        <Route path=\"/game\" strict>\n          <Game />\n        </Route>\n        <Route path=\"/\" strict>\n          <Home />\n        </Route>\n      </Switch>\n    </Router>\n  );\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './App';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n"],"sourceRoot":""}